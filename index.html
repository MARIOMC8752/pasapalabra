<html><head><base href="."><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><style>
    body {
        font-family: Arial, sans-serif;
        display: flex;
        flex-direction: column;
        align-items: center;
        background: linear-gradient(135deg, #1a2a6c, #b21f1f, #fdbb2d);
        color: white;
        min-height: 100vh;
        margin: 0;
        padding: 20px;
    }

    h1 {
        text-align: center;
        font-size: clamp(24px, 4vw, 36px);
    }

    #game-container {
        width: 100%;
        max-width: 800px;
        margin: 80px auto 20px auto;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 15px;
        background: rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(10px);
        border-radius: 20px;
        padding: 20px;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
    }

    #initial-controls {
        display: flex;
        flex-direction: column;
        align-items: center;
        margin: 20px;
    }

    #rosco-container {
        position: relative;
        width: min(40vw, 250px);
        height: min(40vw, 250px);
        margin: 80px auto; /* Increased top margin from 20px to 40px */
        display: flex;
        justify-content: center;
        align-items: center;
    }

    #timer {
        position: absolute;
        top: 60%; /* Changed from 55% to move down slightly more */
        left: 50%;
        transform: translate(-50%, -50%);
        font-size: 2em;
        font-weight: bold;
        z-index: 2;
        background: rgba(0,0,0,0.2);
        padding: 10px 20px;
        border-radius: 10px;
        text-align: center;
        min-width: 100px;
        display: flex;
        justify-content: center;
        align-items: center;
    }

    .letter-button {
        position: absolute;
        width: 40px;
        height: 40px;
        border-radius: 50%;
        border: none;
        background: #3498db;
        color: white;
        font-size: 16px;
        cursor: default;
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        font-weight: bold;
        transform: translate(-50%, -50%);
        box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    }

    .letter-button:hover {
        transform: translate(-50%, -50%) scale(1.15);
    }

    .letter-button.active { 
        animation: pulse 2s infinite;
        background: white;
        color: #333;
        box-shadow: 0 0 15px rgba(255,255,255,0.8);
    }

    @keyframes pulse {
        0% { box-shadow: 0 0 0 0 rgba(255, 255, 255, 0.7); }
        70% { box-shadow: 0 0 0 15px rgba(255, 255, 255, 0); }
        100% { box-shadow: 0 0 0 0 rgba(255, 255, 255, 0); }
    }

    .letter-button.correct { 
        background: #2ecc71;
        box-shadow: 0 0 15px rgba(46,204,113,0.5);
    }
    .letter-button.incorrect { 
        background: #e74c3c;
        box-shadow: 0 0 15px rgba(231,76,60,0.5);
    }
    .letter-button.passed { 
        background: #3498db;
        box-shadow: 0 0 15px rgba(52,152,219,0.5);
    }

    #word-display {
        font-size: clamp(20px, 4vw, 24px);
        margin: 20px;
        text-align: center;
        font-weight: bold;
        color: white;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
    }

    #description {
        font-size: clamp(16px, 3vw, 18px);
        margin: 20px;
        text-align: center;
        max-width: 600px;
        color: rgba(255, 255, 255, 0.9);
    }

    #controls {
        margin: 10px 0;
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        justify-content: center;
    }

    button {
        padding: 10px 20px;
        font-size: clamp(14px, 2vw, 16px);
        cursor: pointer;
        border: none;
        border-radius: 5px;
        background: rgba(255, 255, 255, 0.2);
        backdrop-filter: blur(5px);
        color: white;
        transition: all 0.3s ease;
    }

    button:hover {
        background: rgba(255, 255, 255, 0.3);
        transform: translateY(-2px);
    }

    #answer {
        padding: 10px;
        font-size: 16px;
        border: 1px solid rgba(255, 255, 255, 0.2);
        border-radius: 5px;
        width: clamp(200px, 50vw, 300px);
        background: rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(5px);
        color: white;
    }

    #answer::placeholder {
        color: rgba(255, 255, 255, 0.6);
    }

    #editor {
        width: 100%;
        max-width: 1200px; /* Increased from 1000px */
        margin: 80px auto 20px auto;
        padding: 20px;
        background: rgba(255, 255, 255, 0.15);
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.2);
        border-radius: 10px;
        box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }

    #time-settings {
        margin: 20px 0;
    }

    textarea {
        width: 100%;
        min-height: 100px;
        margin: 10px 0;
        padding: 10px;
        border: 1px solid #ccc;
        border-radius: 5px;
        font-size: 14px;
    }

    #score {
        font-size: clamp(16px, 3vw, 20px);
        margin: 20px;
        font-weight: bold;
        text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
    }

    #audio-controls {
        margin: 20px;
        display: flex;
        gap: 10px;
    }

    .game-state-btn {
        font-size: 1.2em;
        padding: 15px 30px;
        margin: 10px;
        background: rgba(255, 255, 255, 0.2);
        border: 2px solid rgba(255, 255, 255, 0.3);
        border-radius: 8px;
    }
</style></head><body>
    <h1>Pasapalabra</h1>
  
    <button id="exitGame" class="game-state-btn" onclick="exitCurrentGame()" style="display:none">Salir del Juego</button>

    <div id="editor">
        <h2>Editor de Palabras</h2>
        <button id="toggleEditorBtn">Mostrar/Ocultar Editor</button>
        <div id="editorContent" style="display: none;">
            <div id="time-settings">
                <label for="gameTime">Tiempo de juego (segundos):</label>
                <input type="number" id="gameTime" value="9999" min="60" max="600">
            </div>
            <textarea id="gameData">
A,Amigos,Nombre de la secci칩n donde te aparecen las personas que has a침adido
B,Block Dash,Modo mas jugado de Stumble Guys
C,Corona,Objeto que te dan al ganar una partida
D,Dado,Nombre en espa침ol de una skin de la colaboraci칩n de monopoly con forma cuadrada
E,Estrellas,Recurso necesario para avanzar en el Stumble Pass
F,Ford,Unica colaboraci칩n con una marca de coches reales
G,Goat,Lo que es Gustavito39
H,Hot Wheels,Unica colaboraci칩n con una marca de coches de juguete
I,Ice caramba,Mapa de carreras ispirado en icy heights pero mas dif칤cil
J,Jinx,Recolor de la skin de meowmer tambi칠n conocida como la pijamada
K,Kitka Games,Antigua empresa due침a de Stumble Guys
L,Llaves de habilidad,쮺on que se compran las hablilidades?
M,Madera,Primer rango del competitivo
N,Nos,Skin de halloween de Dr치cula
칌,Ca침칩n,Contiene:Objeto principal del mapa canon climb
O,Oro,Cuarto rango del competitivo
P,Pro,Rango m치s bajo de creadores de contenido de Stumble Guys
Q,Esquivar,Contiene:Lo que haces para no chocarte con algo
R,RP,Recurso necesario para avanzar en el pase del competitivo
S,Scopely,Empresa que dirige Stumble Guys actualmente
T,Taller,Sitio donde se crean mapas personalizados
U,UFOMG!,Mapa de eliminaci칩n donde hay ovnis y el final del nombre es una exclamaci칩n
V,Volc치n,Lava land es un...
W,Win,Cuando ganas te haces una...
X,Xp,Objeto que sirve para subir de nivel en Stumble Guys
Y,Yeti yeets,Mapa de eliminaci칩n donde un yeti te tira bolas de nieve
Z,Zeus,Skin mitica basada en el dios del trueno</textarea>
            <button onclick="updateGame()">Actualizar Juego</button>
        </div>
    </div>

    <div id="game-container">
        <div id="rosco-container">
            <div id="timer">5:00</div>
        </div>
        <div id="word-display"></div>
        <div id="description"></div>
        <div id="controls">
            <input type="text" id="answer" placeholder="Escribe tu respuesta">
            <button onclick="checkAnswer()">Comprobar</button>
            <button onclick="passTurn()">Pasar</button>
        </div>
        <div id="score">Aciertos: 0 - Fallos: 0</div>
    </div>

<script>
let gameData = [];
let currentIndex = 0;
let correctAnswers = 0;
let incorrectAnswers = 0;
let timeLeft;
let timerInterval;

const gameAudio = {
    background: new Audio(),
    correct: new Audio(),
    incorrect: new Audio(),
    victory: new Audio()
};

function initAudio() {
    const audioSources = {
        background: '',
        correct: '',
        incorrect: '',
        victory: ''
    };

    for (const [key, audio] of Object.entries(gameAudio)) {
        audio.src = audioSources[key];
        audio.addEventListener('error', (e) => {
            console.warn(`Error loading audio ${key}:`, e);
        });
    }

    gameAudio.background.loop = true;
    gameAudio.background.volume = 0.3;
}

document.addEventListener('DOMContentLoaded', function() {
    const toggleEditorBtn = document.getElementById('toggleEditorBtn');
    toggleEditorBtn.addEventListener('click', function() {
        const editor = document.getElementById('editorContent');
        editor.style.display = editor.style.display === 'none' ? 'block' : 'none';
    });
});

function playAudio(audio) {
    if (audio.readyState >= 2) {
        audio.currentTime = 0;
        try {
            audio.play().catch(e => console.warn('Audio playback failed:', e));
        } catch (e) {
            console.warn('Audio playback failed:', e);
        }
    } else {
        console.warn('Audio not ready to play');
    }
}

function initializeGame() {
    const defaultData = document.getElementById('gameData').value;
    const lines = defaultData.trim().split('\n');
    gameData = lines.map(line => {
        const [letter, word, description] = line.split(',');
        return { letter: letter.trim(), word: word.trim(), description: description.trim() };
    });
    
    createRosco();
    showCurrentWord();
    updateScore();
    startTimer();
}

function createRosco() {
    const rosco = document.getElementById('rosco-container');
    rosco.innerHTML = '<div id="timer">5:00</div>';
    const isMobile = window.innerWidth < 768;
    const radiusScale = isMobile ? 4 : 3.2;
    
    gameData.forEach((item, index) => {
        const button = document.createElement('button');
        button.className = 'letter-button';
        button.textContent = item.letter;
        
        const angle = (index * 360 / gameData.length) * (Math.PI / 180);
        const radius = Math.min(rosco.offsetWidth, rosco.offsetHeight) / radiusScale;
        const x = 50 + (radius * Math.cos(angle - Math.PI/2));
        const y = 50 + (radius * Math.sin(angle - Math.PI/2));
        
        button.style.left = `${x}%`;
        button.style.top = `${y}%`;
        rosco.appendChild(button);
    });
}

function startTimer() {
    if (timerInterval) clearInterval(timerInterval);
    timeLeft = parseInt(document.getElementById('gameTime').value);
    updateTimerDisplay();
    
    timerInterval = setInterval(() => {
        timeLeft--;
        updateTimerDisplay();
        if (timeLeft <= 0) {
            clearInterval(timerInterval);
            endGame();
        }
    }, 1000);
}

function updateTimerDisplay() {
    const minutes = Math.floor(timeLeft / 60);
    const seconds = timeLeft % 60;
    document.getElementById('timer').textContent = 
        `${minutes}:${seconds.toString().padStart(2, '0')}`;
}

function endGame() {
    document.getElementById('answer').disabled = true;
    const buttons = document.querySelectorAll('button');
    buttons.forEach(button => {
        if (button.id !== 'toggleEditorBtn') button.disabled = true;
    });
}

function showCurrentWord() {
    const current = gameData[currentIndex];
    document.getElementById('word-display').textContent = `Letra ${current.letter}`;
    document.getElementById('description').textContent = current.description;
    document.getElementById('answer').value = '';
    updateRosco();
}

function updateRosco() {
    const buttons = document.querySelectorAll('.letter-button');
    buttons.forEach((button, index) => {
        if (index === currentIndex) {
            button.classList.remove('correct', 'incorrect', 'passed');
            button.classList.add('active');
        } else if (!button.classList.contains('correct') && 
                   !button.classList.contains('incorrect') && 
                   !button.classList.contains('passed')) {
            button.className = 'letter-button';
        }
    });
}

function isGameComplete() {
    const allAnswered = gameData.every((_, index) => {
        const button = document.querySelectorAll('.letter-button')[index];
        return button.classList.contains('correct') || button.classList.contains('incorrect');
    });
    
    if (allAnswered) {
        clearInterval(timerInterval);
        goToFirstPassed();
    }
    return allAnswered;
}

function goToFirstPassed() {
    const hasPassedLetters = gameData.some((_, index) => {
        const button = document.querySelectorAll('.letter-button')[index];
        return button.classList.contains('passed');
    });

    if (hasPassedLetters) {
        const firstPassedIndex = Array.from(document.querySelectorAll('.letter-button'))
            .findIndex(button => button.classList.contains('passed'));
        currentIndex = firstPassedIndex;
        showCurrentWord();
    }
}

function checkAnswer() {
    const userAnswer = document.getElementById('answer').value.trim().toLowerCase();
    const correctWord = gameData[currentIndex].word.toLowerCase();
    
    const buttons = document.querySelectorAll('.letter-button');
    
    const normalizedUserAnswer = userAnswer.normalize("NFD").replace(/[\u0300-\u036f]/g, "");
    const normalizedCorrectWord = correctWord.normalize("NFD").replace(/[\u0300-\u036f]/g, "");
    
    if (normalizedUserAnswer === normalizedCorrectWord) {
        if (sfxEnabled) playAudio(gameAudio.correct);
        buttons[currentIndex].classList.remove('active', 'passed', 'incorrect');
        buttons[currentIndex].classList.add('correct');
        correctAnswers++;
        nextWord();
    } else {
        if (sfxEnabled) playAudio(gameAudio.incorrect);
        buttons[currentIndex].classList.remove('active', 'passed', 'correct');
        buttons[currentIndex].classList.add('incorrect');
        incorrectAnswers++;
        nextWord();
    }
    
    updateScore();
    if (isGameComplete() && sfxEnabled) {
        playAudio(gameAudio.victory);
    }
}

function nextWord() {
    let nextIndex = currentIndex;
    do {
        nextIndex = (nextIndex + 1) % gameData.length;
        const button = document.querySelectorAll('.letter-button')[nextIndex];
        if (!button.classList.contains('correct') && !button.classList.contains('incorrect')) {
            currentIndex = nextIndex;
            showCurrentWord();
            return;
        }
    } while (nextIndex !== currentIndex && !isGameComplete());
}

function passTurn() {
    const buttons = document.querySelectorAll('.letter-button');
    buttons[currentIndex].classList.remove('active', 'correct', 'incorrect');
    buttons[currentIndex].classList.add('passed');
    nextWord();
}

function updateScore() {
    document.getElementById('score').textContent = 
        `Aciertos: ${correctAnswers} - Fallos: ${incorrectAnswers}`;
}

let musicEnabled = false;
let sfxEnabled = false;

function toggleMusic() {
    musicEnabled = !musicEnabled;
    const btn = document.getElementById('musicToggle');
    if (musicEnabled) {
        playAudio(gameAudio.background);
        btn.innerHTML = '游댉 M칰sica';
    } else {
        gameAudio.background.pause();
        btn.innerHTML = '游댆 M칰sica';
    }
}

function updateGame() {
    if (timerInterval) clearInterval(timerInterval);
    initializeGame();
    correctAnswers = 0;
    incorrectAnswers = 0;
    currentIndex = 0;
    updateScore();
    document.getElementById('answer').disabled = false;
    const buttons = document.querySelectorAll('button');
    buttons.forEach(button => button.disabled = false);
}

function startNewGame() {
    document.getElementById('initial-controls').style.display = 'none';
    document.getElementById('game-container').style.display = 'flex';
    document.getElementById('exitGame').style.display = 'block';
    updateGame();
}

function exitCurrentGame() {
    if(confirm('쯉eguro que quieres salir del juego?')) {
        clearInterval(timerInterval);
        document.getElementById('initial-controls').style.display = 'flex';
        document.getElementById('game-container').style.display = 'none';
        document.getElementById('exitGame').style.display = 'none';
        document.getElementById('editorContent').style.display = 'none';
    }
}

window.onload = function() {
    initAudio();
    initializeGame();
};

window.addEventListener('resize', () => {
    createRosco();
});
</script>

</body></html>
